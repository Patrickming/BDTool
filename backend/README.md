# KOL-BD-Tool åç«¯ API

åŸºäº TypeScript + Express + Prisma æ„å»ºçš„ KOL ç®¡ç†ç³»ç»Ÿåç«¯ APIã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pnpm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å†™é…ç½®ï¼š

```bash
cp .env.example .env
```

**é‡è¦é…ç½®é¡¹ï¼š**
- `DATABASE_URL`: æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
- `JWT_SECRET`: JWT å¯†é’¥ï¼ˆè‡³å°‘ 32 ä¸ªå­—ç¬¦ï¼‰
- `OPENAI_API_KEY`: OpenAI API å¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äº AI åŠŸèƒ½ï¼‰

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”Ÿæˆ Prisma Client
pnpm db:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm db:migrate

# (å¯é€‰) å¡«å……æµ‹è¯•æ•°æ®
pnpm db:seed
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

è®¿é—® `http://localhost:3000/health` æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€ã€‚

## ğŸ“¦ å¯ç”¨è„šæœ¬

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `pnpm dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰ |
| `pnpm build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ |
| `pnpm start` | è¿è¡Œç”Ÿäº§ç‰ˆæœ¬ |
| `pnpm test` | è¿è¡Œæµ‹è¯• |
| `pnpm lint` | ä»£ç æ£€æŸ¥ |
| `pnpm lint:fix` | è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜ |
| `pnpm format` | æ ¼å¼åŒ–ä»£ç  |
| `pnpm db:migrate` | è¿è¡Œæ•°æ®åº“è¿ç§» |
| `pnpm db:generate` | ç”Ÿæˆ Prisma Client |
| `pnpm db:studio` | æ‰“å¼€ Prisma Studioï¼ˆæ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼‰ |
| `pnpm db:reset` | é‡ç½®æ•°æ®åº“ï¼ˆå±é™©æ“ä½œï¼ï¼‰ |

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ features/          # åŠŸèƒ½æ¨¡å—ï¼ˆæŒ‰ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†ï¼‰
â”‚   â”œâ”€â”€ auth/         # è®¤è¯æ¨¡å—ï¼ˆæ³¨å†Œã€ç™»å½•ã€JWTï¼‰
â”‚   â”œâ”€â”€ kols/         # KOL ç®¡ç†ï¼ˆCRUDã€ç­›é€‰ã€è¯„åˆ†ï¼‰
â”‚   â”œâ”€â”€ templates/    # æ¨¡æ¿ç®¡ç†ï¼ˆåˆ›å»ºã€ç¼–è¾‘ã€AI ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ contacts/     # è”ç³»è®°å½•ï¼ˆå†å²ã€ç»Ÿè®¡ï¼‰
â”‚   â””â”€â”€ ai/           # AI é›†æˆï¼ˆOpenAIã€Anthropicï¼‰
â”œâ”€â”€ common/           # å…¬å…±ä»£ç 
â”‚   â”œâ”€â”€ middleware/   # ä¸­é—´ä»¶ï¼ˆé”™è¯¯å¤„ç†ã€æ—¥å¿—ã€è®¤è¯ï¼‰
â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°ï¼ˆå“åº”æ ¼å¼ã€å¼‚æ­¥å¤„ç†ï¼‰
â”‚   â””â”€â”€ errors/       # è‡ªå®šä¹‰é”™è¯¯ç±»
â”œâ”€â”€ config/           # é…ç½®ï¼ˆç¯å¢ƒå˜é‡ã€æ—¥å¿—ã€CORSï¼‰
â”œâ”€â”€ database/         # æ•°æ®åº“ï¼ˆPrisma Clientï¼‰
â”œâ”€â”€ types/            # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ app.ts            # Express åº”ç”¨é…ç½®
â””â”€â”€ server.ts         # æœåŠ¡å™¨å…¥å£
```

## ğŸ“š æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Node.js** | 18+ | è¿è¡Œæ—¶ |
| **TypeScript** | 5.7 | ç±»å‹å®‰å…¨ |
| **Express** | 4.21 | Web æ¡†æ¶ |
| **Prisma** | 6.1 | ORMï¼ˆæ•°æ®åº“ï¼‰|
| **Zod** | 3.24 | æ•°æ®éªŒè¯ |
| **JWT** | 9.0 | èº«ä»½è®¤è¯ |
| **Pino** | 9.6 | é«˜æ€§èƒ½æ—¥å¿— |
| **OpenAI** | 4.78 | AI é›†æˆ |
| **Vitest** | 2.1 | æµ‹è¯•æ¡†æ¶ |

### æ•°æ®åº“æ”¯æŒ

- **å¼€å‘ç¯å¢ƒ**: SQLiteï¼ˆæ— éœ€é¢å¤–å®‰è£…ï¼‰
- **ç”Ÿäº§ç¯å¢ƒ**: PostgreSQL 14+

## ğŸ” API ç«¯ç‚¹

### å¥åº·æ£€æŸ¥

- `GET /health` - æœåŠ¡å™¨å¥åº·çŠ¶æ€

### è®¤è¯ï¼ˆå¾…å®ç°ï¼‰

- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/v1/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

### KOL ç®¡ç†ï¼ˆå¾…å®ç°ï¼‰

- `GET /api/v1/kols` - è·å– KOL åˆ—è¡¨
- `POST /api/v1/kols` - åˆ›å»º KOL
- `GET /api/v1/kols/:id` - è·å– KOL è¯¦æƒ…
- `PUT /api/v1/kols/:id` - æ›´æ–° KOL
- `DELETE /api/v1/kols/:id` - åˆ é™¤ KOL

### æ¨¡æ¿ç®¡ç†ï¼ˆå¾…å®ç°ï¼‰

- `GET /api/v1/templates` - è·å–æ¨¡æ¿åˆ—è¡¨
- `POST /api/v1/templates` - åˆ›å»ºæ¨¡æ¿
- `POST /api/v1/templates/generate` - AI ç”Ÿæˆæ¨¡æ¿

å®Œæ•´ API æ–‡æ¡£è¯·å‚è€ƒ `docs/API.md`ã€‚

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ ESLint å’Œ Prettier ä¿è¯ä»£ç è´¨é‡ï¼š

```bash
# æ£€æŸ¥ä»£ç 
pnpm lint

# è‡ªåŠ¨ä¿®å¤
pnpm lint:fix

# æ ¼å¼åŒ–ä»£ç 
pnpm format
```

### æ•°æ®åº“æ“ä½œ

```bash
# æŸ¥çœ‹æ•°æ®åº“ï¼ˆGUIï¼‰
pnpm db:studio

# åˆ›å»ºæ–°è¿ç§»
pnpm db:migrate

# é‡ç½®æ•°æ®åº“ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®ï¼ï¼‰
pnpm db:reset
```

### æ·»åŠ æ–°åŠŸèƒ½æ¨¡å—

1. åœ¨ `src/features/` åˆ›å»ºæ–°æ–‡ä»¶å¤¹
2. åˆ›å»ºå­ç›®å½•ï¼š`controllers/`, `services/`, `dto/`, `routes/`
3. å®ç°ä¸šåŠ¡é€»è¾‘
4. åœ¨ `src/routes.ts` æ³¨å†Œè·¯ç”±

### TypeScript è·¯å¾„åˆ«å

é¡¹ç›®é…ç½®äº†è·¯å¾„åˆ«åï¼Œç®€åŒ–å¯¼å…¥ï¼š

```typescript
// âŒ ä¸æ¨è
import { logger } from '../../config/logger.config';

// âœ… æ¨è
import { logger } from '@config/logger.config';
```

**å¯ç”¨åˆ«åï¼š**
- `@/*` â†’ `src/*`
- `@features/*` â†’ `src/features/*`
- `@common/*` â†’ `src/common/*`
- `@config/*` â†’ `src/config/*`
- `@database/*` â†’ `src/database/*`

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œæµ‹è¯•ï¼ˆUI ç•Œé¢ï¼‰
pnpm test:ui

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
pnpm test:coverage
```

## ğŸ“ å¾…å®ç°åŠŸèƒ½

### é«˜ä¼˜å…ˆçº§
- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ˆæ³¨å†Œã€ç™»å½•ï¼‰
- [ ] KOL CRUD API
- [ ] æ¨¡æ¿ç®¡ç† API
- [ ] JWT ä¸­é—´ä»¶

### ä¸­ä¼˜å…ˆçº§
- [ ] è”ç³»è®°å½• API
- [ ] KOL è´¨é‡è¯„åˆ†ç®—æ³•
- [ ] æ•°æ®ç­›é€‰å’Œæœç´¢
- [ ] åˆ†é¡µåŠŸèƒ½

### ä½ä¼˜å…ˆçº§
- [ ] OpenAI é›†æˆï¼ˆAI ç”Ÿæˆæ¨¡æ¿ï¼‰
- [ ] Anthropic Claude é›†æˆ
- [ ] ç»Ÿè®¡åˆ†æ API
- [ ] å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

å¦‚æœ 3000 ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ `PORT` é…ç½®ã€‚

### 2. æ•°æ®åº“è¿æ¥å¤±è´¥

ç¡®ä¿ `.env` æ–‡ä»¶ä¸­çš„ `DATABASE_URL` é…ç½®æ­£ç¡®ã€‚

### 3. Prisma Client æœªç”Ÿæˆ

è¿è¡Œ `pnpm db:generate` é‡æ–°ç”Ÿæˆ Prisma Clientã€‚

### 4. TypeScript ç¼–è¯‘é”™è¯¯

è¿è¡Œ `pnpm build` æ£€æŸ¥ TypeScript é”™è¯¯ã€‚

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ€»è§ˆ](../README.md)
- [éœ€æ±‚æ–‡æ¡£](../docs/REQUIREMENTS.md)
- [æ•°æ®åº“è®¾è®¡](../docs/DATABASE.md)
- [å¼€å‘æ—¥å¿—](../docs/DEVELOPMENT.md)

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ç”± KCEX BD å›¢é˜Ÿä½¿ç”¨ â¤ï¸ æ„å»º**
